Thread communication using memory sharing